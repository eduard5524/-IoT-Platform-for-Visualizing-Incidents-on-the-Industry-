<div class="row">
  <div class="col-md-6">
    <h1 class="header-modal" mat-dialog-title *ngIf="this.create == true">{{ 'MATERIAL_MNG.create' | translate }}</h1>
    <h1 class="header-modal" mat-dialog-title *ngIf="this.create == false && this.edit == true">{{ 'MATERIAL_MNG.edit' |
      translate }}</h1>
    <h1 class="header-modal" mat-dialog-title *ngIf="this.create == false && this.edit == false">{{
      'MATERIAL_MNG.detail'
      | translate }}</h1>
  </div>
  <div class="col-md-6">
    <div *ngIf="!edit" style="float:right">
      <mat-form-field>
        <mat-label>{{'MATERIAL_MNG.export' | translate}}</mat-label>
        <mat-select (selectionChange)="exportFile($event.value)">
          <mat-option *ngFor="let export of export_array" [value]="export">
            {{export}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-icon class="ml-5">share</mat-icon>

    </div>
  </div>
</div>

<div mat-dialog-content>


  <div class="p-5" id="print_this">

    <!--PRIMERA FILA-->
    <div class="mb-4 row col-md-12">
      <mat-form-field class="col-md-3" [ngClass]="mobileClass('field')">
        <input matInput readonly type="date" [disabled]="!edit" name="po_date" id="po_date"
          [(ngModel)]="purchase_order.date" placeholder="{{'MATERIAL_MNG.po_date' | translate}}">
      </mat-form-field>

      <mat-form-field class="col-md-2" [ngClass]="mobileClass('field')">
        <input matInput readonly type="text" [disabled]="!edit" name="project_number" id="project_number"
          [(ngModel)]="purchase_order.project_num" placeholder="{{'MATERIAL_MNG.project_number' | translate}}">
      </mat-form-field>

      <mat-form-field class="col-md-3" [ngClass]="mobileClass('field')">
        <input matInput readonly type="text" [disabled]="!edit" name="ref_number" id="ref_number"
          [(ngModel)]="purchase_order.ref_number" placeholder="{{'MATERIAL_MNG.ref_number' | translate}}">
      </mat-form-field>

      <mat-form-field class="col-md-4" [ngClass]="mobileClass('field')">
        <input matInput readonly type="text" [disabled]="!edit" name="purchase_num" id="purchase_num"
          value="{{purchase_order.project_num}}_{{purchase_order.ref_number}}"
          placeholder="{{'MATERIAL_MNG.purchase_num' | translate}}">
      </mat-form-field>
    </div>
    <hr>
    <!--BILL TO y SHIP TO-->
    <div class="row">
      <div class="col-md-6">
        <h5>{{'MATERIAL_MNG.bill_to' | translate}}</h5>
        <hr>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="company_billto" id="company_billto"
            [(ngModel)]="purchase_order.company_billto" placeholder="{{'MATERIAL_MNG.company' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="vat_billto" id="vat_billto"
            [(ngModel)]="purchase_order.vat_billto" placeholder="{{'MATERIAL_MNG.vat' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="address_billto" id="address_billto"
            [(ngModel)]="purchase_order.address_billto" placeholder="{{'MATERIAL_MNG.address' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="country_billto" id="country_billto"
            [(ngModel)]="purchase_order.country_billto" placeholder="{{'MATERIAL_MNG.country' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="phone_billto" id="phone_billto"
            [(ngModel)]="purchase_order.phone_billto" placeholder="{{'MATERIAL_MNG.phone' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="email_billto" id="email_billto"
            [(ngModel)]="purchase_order.email_billto" placeholder="{{'MATERIAL_MNG.email' | translate}}">
        </mat-form-field>
      </div>

      <div class="col-md-6">
        <h5>{{'MATERIAL_MNG.ship_to' | translate}}</h5>
        <hr>

        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="company_shipto" id="company_shipto"
            [(ngModel)]="purchase_order.company_shipto" placeholder="{{'MATERIAL_MNG.company' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="vat_shipto" id="vat_shipto"
            [(ngModel)]="purchase_order.vat_shipto" placeholder="{{'MATERIAL_MNG.vat' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="address_shipto" id="address_shipto"
            [(ngModel)]="purchase_order.address_shipto" placeholder="{{'MATERIAL_MNG.address' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="country_shipto" id="country_shipto"
            [(ngModel)]="purchase_order.country_shipto" placeholder="{{'MATERIAL_MNG.country' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="phone_shipto" id="phone_shipto"
            [(ngModel)]="purchase_order.phone_shipto" placeholder="{{'MATERIAL_MNG.phone' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="email_shipto" id="email_shipto"
            [(ngModel)]="purchase_order.email_shipto" placeholder="{{'MATERIAL_MNG.email' | translate}}">
        </mat-form-field>
      </div>
    </div>
    <!--PROVIDER-->
    <div class="mt-3 row">
      <div class="col-md-8">
        <h5>{{'MATERIAL_MNG.provider' | translate}}</h5>
        <hr>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="name_provider" id="name_provider"
            [(ngModel)]="provider.name" placeholder="{{'MATERIAL_MNG.name' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="vat_provider" id="vat_provider"
            [(ngModel)]="provider.vat" placeholder="{{'MATERIAL_MNG.vat' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="address_provider" id="address_provider"
            [(ngModel)]="provider.address" placeholder="{{'MATERIAL_MNG.address' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="phone_provider" id="phone_provider"
            [(ngModel)]="provider.phone" placeholder="{{'MATERIAL_MNG.phone' | translate}}">
        </mat-form-field>
        <br>
        <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
          <input matInput readonly type="text" [disabled]="!edit" name="email_provider" id="email_provider"
            [(ngModel)]="provider.email" placeholder="{{'MATERIAL_MNG.email' | translate}}">
        </mat-form-field>
      </div>
    </div>
    <!--ITEM LIST-->
    <div class="mt-3 row">
      <div class="col-md-12">
        <h5>{{'MATERIAL_MNG.item_list' | translate}}</h5>
        <table id="myTable" class="table order-list table-striped">

          <tbody id="row_items_body">
            <!--row clone-->
            <tr id="row_items" class="row_to_clone d-none row_origin">
              <td>
                <mat-form-field floatLabel="never" [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <mat-label>{{'MATERIAL_MNG.component' | translate}}</mat-label>
                  <select matNativeControl class="mr-3 product_list" name="product_list" id="product_list">
                    <option>{{'MATERIAL_MNG.select_item' | translate}}</option>
                    <option *ngFor="let product of product_list" id="{{product.id}}"
                      value="{{product.codigo_articulo}}|--|{{product.price}}|--|{{product.id}}">{{product.title}}
                    </option>
                  </select>
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" name="reference" class="w-100 reference">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput type="text" name="quantity" class="w-100 quantity">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" name="unit_price" class="w-100 unit_price">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" name="amount" class="w-100 amount">
                </mat-form-field>
              </td>
              <td><a class="deleteRow"></a></td>
            </tr>
            <!--row actual items-->
            <tr *ngFor="let product of actual_products" id="row_actual" class="row_to_clone row_origin">
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <select [disabled]="!edit" matNativeControl class="mr-3 product_list" name="product_list"
                    id="product_list" placeholder="{{'MATERIAL_MNG.item' | translate}}">
                    <option id="{{product.id}}"
                      value="{{product.codigo_articulo}}|--|{{product.price}}|--|{{product.id}}">{{product.title}}
                    </option>
                  </select>
                </mat-form-field>

              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="reference" class="w-100 reference"
                    placeholder="{{'MATERIAL_MNG.cod_art' | translate}}" value="{{product.codigo_articulo}}">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="quantity" class="w-100 quantity"
                    placeholder="{{'MATERIAL_MNG.quantity' | translate}}" value="{{product.quantity}}">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="unit_price" class="w-100 unit_price"
                    placeholder="{{'MATERIAL_MNG.price' | translate}}" value="{{product.price_sin_iva}}">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="amount" class="w-100 amount"
                    placeholder="{{'MATERIAL_MNG.amount' | translate}}" value="{{product.price}}">
                </mat-form-field>
              </td>
              <td *ngIf="this.create == true || this.edit == true"><a class="deleteRow"></a></td>
              <td *ngIf="this.create == true || this.edit == true"><input type="button"
                  class="ibtnDel btn btn-md btn-danger " value="✗"></td>
            </tr>

          </tbody>
          <tfoot>
            <tr class="row_origin">
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="totaliva" id="totaliva" class="totaliva"
                    placeholder="{{'MATERIAL_MNG.iva' | translate}} (€)">
                </mat-form-field>
              </td>
            </tr>
            <tr class="row_origin">
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="totalamount" id="totalamount"
                    class="totalamount" placeholder="{{'MATERIAL_MNG.subtotal' | translate}} (€)">
                </mat-form-field>
              </td>
            </tr>
            <tr class="row_origin">
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>
                <mat-form-field [style.width.%]="100" [ngClass]="mobileClass('field')">
                  <input matInput readonly type="text" [disabled]="!edit" name="totalamountiva" id="totalamountiva"
                    class="totalamountiva" placeholder="{{'MATERIAL_MNG.total_amount' | translate | uppercase}} (€)">
                </mat-form-field>
              </td>
            </tr>
            <tr class="row_origin">
              <td colspan="5" style="text-align: left;">
                <input type="button" class="btn btn-lg btn-block" id="addrow"
                  value="{{'MATERIAL_MNG.add_row' | translate}}" />
              </td>
            </tr>
            <tr>
            </tr>
          </tfoot>
        </table>

      </div>
    </div>
    <p>{{'MATERIAL_MNG.purchase_order_note_1' | translate}}</p>
    <p>{{'MATERIAL_MNG.purchase_order_note_2' | translate}}</p>
  </div>

</div>

<mat-divider></mat-divider>

<div style="float:right" mat-dialog-actions>
  <button class="buttons-modal" [ngClass]="mobileClass('button')" mat-raised-button (click)="onNoClick()">{{
    'MATERIAL_MNG.cancel' | translate }}</button>
  <button class="buttons-modal" [ngClass]="mobileClass('button')" mat-raised-button color="primary" *ngIf="edit"
    (click)="updatePurchaseOrder()">{{ 'MATERIAL_MNG.save' | translate }}</button>
  <button class="buttons-modal" [ngClass]="mobileClass('button')" mat-raised-button color="primary"
    *ngIf="!edit" (click)="onClickEdit()">{{ 'MATERIAL_MNG.edit' | translate }}</button>
</div>